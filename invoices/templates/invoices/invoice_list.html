{% extends 'dashboard_base.html' %}
{% load static %}
{% block title %}Invoices - InvoiceGen{% endblock %}
{% block content %}
    <div class="space-y-6">
        <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
            <div>
                <h1 class="text-3xl font-bold tracking-tight">Invoices</h1>
                <p class="text-muted-foreground mt-1">Manage and track your client billing.</p>
            </div>
            <div class="flex items-center gap-3">
                <a href="{% url 'invoice_create' %}">
                    <c-button>
                    <svg class="mr-2 h-4 w-4"
                         xmlns="http://www.w3.org/2000/svg"
                         fill="none"
                         viewBox="0 0 24 24"
                         stroke-width="2"
                         stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                    </svg>
                    Create Invoice
                    </c-button>
                </a>
            </div>
        </div>
        <c-card>
        <div class="relative w-full overflow-auto -mx-6">
            <table class="w-full caption-bottom text-sm">
                <thead class="bg-muted/50 [&_tr]:border-b">
                    <tr class="border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted">
                        <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0">
                            Number
                        </th>
                        <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0">
                            Client
                        </th>
                        <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0">Date</th>
                        <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0">
                            Status
                        </th>
                        <th class="h-12 px-4 text-right align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0">
                            Total
                        </th>
                        <th class="h-12 px-4 align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0">Actions</th>
                    </tr>
                </thead>
                <tbody class="[&_tr:last-child]:border-0">
                    {% for invoice in invoices %}
                        <tr class="border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted">
                            <td class="p-4 align-middle font-medium text-primary">{{ invoice.invoice_number }}</td>
                            <td class="p-4 align-middle">
                                <div class="font-medium">{{ invoice.project.client.name }}</div>
                                <div class="text-xs text-muted-foreground">{{ invoice.project.name }}</div>
                            </td>
                            <td class="p-4 align-middle text-muted-foreground">{{ invoice.date }}</td>
                            <td class="p-4 align-middle">
                                <span class="inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 {% if invoice.status == 'paid' %}bg-secondary text-secondary-foreground{% endif %} {% if invoice.status == 'sent' %}border border-input bg-background hover:bg-accent hover:text-accent-foreground{% endif %} {% if invoice.status == 'draft' %}bg-muted text-muted-foreground{% endif %} {% if invoice.status == 'invalid' %}bg-destructive text-destructive-foreground{% endif %}">
                                    {{ invoice.get_status_display }}
                                </span>
                            </td>
                            <td class="p-4 align-middle text-right font-medium">â‚¬{{ invoice.gross_total|floatformat:2 }}</td>
                            <td class="p-4 align-middle text-right">
                                <div class="flex items-center justify-end gap-2">
                                    <a href="{% url 'invoice_pdf' invoice.id %}" target="_blank">
                                        <c-button variant="ghost" size="sm">
                                        <svg class="mr-2 h-4 w-4"
                                             xmlns="http://www.w3.org/2000/svg"
                                             fill="none"
                                             viewBox="0 0 24 24"
                                             stroke-width="2"
                                             stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3" />
                                        </svg>
                                        PDF
                                        </c-button>
                                    </a>
                                </div>
                            </td>
                        </tr>
                    {% empty %}
                        <tr>
                            <td colspan="6" class="p-8 text-center text-muted-foreground">
                                <div class="flex flex-col items-center gap-2">
                                    <svg class="h-10 w-10 text-muted/30"
                                         xmlns="http://www.w3.org/2000/svg"
                                         fill="none"
                                         viewBox="0 0 24 24"
                                         stroke-width="1.5"
                                         stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
                                    </svg>
                                    <p>No invoices found. Create your first one!</p>
                                </div>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        </c-card>
    </div>
{% endblock %}
